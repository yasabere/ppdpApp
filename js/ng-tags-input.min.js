/*! ngTagsInput v2.0.0 License: MIT */!function(){"use strict";function a(){var a={};return{on:function(b,c){return b.split(" ").forEach(function(b){a[b]||(a[b]=[]),a[b].push(c)}),this},trigger:function(b,c){return angular.forEach(a[b],function(a){a.call(null,c)}),this}}}function b(a,b){return a=a||[],a.length>0&&!angular.isObject(a[0])&&a.forEach(function(c,d){a[d]={},a[d][b]=c}),a}function c(a,b,c){for(var d=null,e=0;e<a.length;e++)if(a[e][c].toLowerCase()===b[c].toLowerCase()){d=a[e];break}return d}var d={backspace:8,tab:9,enter:13,escape:27,space:32,up:38,down:40,comma:188},e=angular.module("ngTagsInput",[]);e.directive("tagsInput",["$timeout","$document","tagsInputConfig",function(e,f,g){function h(a,b){var d,e,f={};return d=function(b){return b[a.displayProperty]},e=function(b,c){b[a.displayProperty]=c},f.items=[],f.addText=function(a){var b={};return e(b,a),f.add(b)},f.add=function(g){var h=d(g).trim();return h.length>=a.minLength&&a.allowedTagsPattern.test(h)&&(a.replaceSpacesWithDashes&&(h=h.replace(/\s/g,"-")),e(g,h),c(f.items,g,a.displayProperty)?b.trigger("duplicate-tag",{$tag:g}):(f.items.push(g),b.trigger("tag-added",{$tag:g}))),g},f.remove=function(a){var c=f.items.splice(a,1)[0];return b.trigger("tag-removed",{$tag:c}),c},f.removeLast=function(){var b,c=f.items.length-1;return a.enableEditingLastTag||f.selected?(f.selected=null,b=f.remove(c)):f.selected||(f.selected=f.items[c]),b},f}return{restrict:"E",require:"ngModel",scope:{tags:"=ngModel",onTagAdded:"&",onTagRemoved:"&"},replace:!1,transclude:!0,templateUrl:"ngTagsInput/tags-input.html",controller:["$scope","$attrs","$element",function(b,c,d){g.load("tagsInput",b,c,{placeholder:[String,"Add a tag"],tabindex:[Number],removeTagSymbol:[String,String.fromCharCode(215)],replaceSpacesWithDashes:[Boolean,!0],minLength:[Number,3],maxLength:[Number],addOnEnter:[Boolean,!0],addOnSpace:[Boolean,!1],addOnComma:[Boolean,!0],addOnBlur:[Boolean,!0],allowedTagsPattern:[RegExp,/.+/],enableEditingLastTag:[Boolean,!1],minTags:[Number],maxTags:[Number],displayProperty:[String,"text"]}),b.events=new a,b.tagList=new h(b.options,b.events),this.registerAutocomplete=function(){var a=d.find("input");return a.on("keydown",function(a){b.events.trigger("input-keydown",a)}),{addTag:function(a){return b.tagList.add(a)},focusInput:function(){a[0].focus()},getTags:function(){return b.tags},getOptions:function(){return b.options},on:function(a,c){return b.events.on(a,c),this}}}}],link:function(a,c,g,h){var i=[d.enter,d.comma,d.space,d.backspace],j=a.tagList,k=a.events,l=a.options,m=c.find("input");k.on("tag-added",a.onTagAdded).on("tag-removed",a.onTagRemoved).on("tag-added duplicate-tag",function(){a.newTag=""}).on("tag-added tag-removed",function(){h.$setViewValue(a.tags)}).on("input-change",function(){j.selected=null}).on("input-blur",function(){l.addOnBlur&&j.addText(a.newTag)}),a.newTag="",a.getDisplayText=function(a){return a[l.displayProperty].trim()},a.track=function(a){return a[l.displayProperty]},a.newTagChange=function(){k.trigger("input-change",a.newTag)},a.$watch("tags",function(c){a.tags=b(c,l.displayProperty),j.items=a.tags}),a.$watch("tags.length",function(a){h.$setValidity("maxTags",angular.isUndefined(l.maxTags)||a<=l.maxTags),h.$setValidity("minTags",angular.isUndefined(l.minTags)||a>=l.minTags)}),m.on("keydown",function(b){if(!b.isImmediatePropagationStopped||!b.isImmediatePropagationStopped()){var c=b.keyCode,e=b.shiftKey||b.altKey||b.ctrlKey||b.metaKey;if(!e&&-1!==i.indexOf(c))if(c===d.enter&&l.addOnEnter||c===d.comma&&l.addOnComma||c===d.space&&l.addOnSpace)j.addText(a.newTag),a.$apply(),b.preventDefault();else if(c===d.backspace&&0===a.newTag.length){var f=j.removeLast();f&&l.enableEditingLastTag&&(a.newTag=f[l.displayProperty]),a.$apply(),b.preventDefault()}}}).on("focus",function(){a.hasFocus||(a.hasFocus=!0,a.$apply())}).on("blur",function(){e(function(){var b=f.prop("activeElement"),d=b===m[0],e=c[0].contains(b);(d||!e)&&(a.hasFocus=!1,k.trigger("input-blur"))})}),c.find("div").on("click",function(){m[0].focus()})}}}]),e.directive("autoComplete",["$document","$timeout","$sce","tagsInputConfig",function(a,e,f,g){function h(a,d){var f,g,h,i={};return g=function(a,b){return a.filter(function(a){return!c(b,a,d.tagsInput.displayProperty)})},i.reset=function(){h=null,i.items=[],i.visible=!1,i.index=-1,i.selected=null,i.query=null,e.cancel(f)},i.show=function(){i.selected=null,i.visible=!0},i.load=function(c,j){return c.length<d.minLength?void i.reset():(e.cancel(f),void(f=e(function(){i.query=c;var e=a({$query:c});h=e,e.then(function(a){e===h&&(a=b(a.data||a,d.tagsInput.displayProperty),i.items=g(a,j),i.items.length>0?i.show():i.reset())})},d.debounceDelay,!1)))},i.selectNext=function(){i.select(++i.index)},i.selectPrior=function(){i.select(--i.index)},i.select=function(a){0>a?a=i.items.length-1:a>=i.items.length&&(a=0),i.index=a,i.selected=i.items[a]},i.reset(),i}function i(a){return a.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}return{restrict:"E",require:"^tagsInput",scope:{source:"&"},templateUrl:"ngTagsInput/auto-complete.html",link:function(b,c,e,j){var k,l,m,n,o,p=[d.enter,d.tab,d.escape,d.up,d.down];g.load("autoComplete",b,e,{debounceDelay:[Number,100],minLength:[Number,3],highlightMatchedText:[Boolean,!0],maxResultsToShow:[Number,10]}),m=b.options,l=j.registerAutocomplete(),m.tagsInput=l.getOptions(),k=new h(b.source,m),n=function(a){return a[m.tagsInput.displayProperty]},o=m.highlightMatchedText?function(a,b){var c=new RegExp(b,"gi");return a.replace(c,"**$&**")}:function(a){return a},b.suggestionList=k,b.addSuggestion=function(){var a=!1;return k.selected&&(l.addTag(k.selected),k.reset(),l.focusInput(),a=!0),a},b.highlight=function(a){var b=n(a);return b=o(b,k.query),b=i(b),b=b.replace(/\*\*(.+?)\*\*/g,"<em>$1</em>"),f.trustAsHtml(b)},b.track=function(a){return n(a)},l.on("tag-added duplicate-tag",function(){k.reset()}).on("input-change",function(a){a?k.load(a,l.getTags()):k.reset()}).on("input-keydown",function(a){var c,e;if(-1!==p.indexOf(a.keyCode)){var f=!1;a.stopImmediatePropagation=function(){f=!0,a.stopPropagation()},a.isImmediatePropagationStopped=function(){return f},k.visible&&(c=a.keyCode,e=!1,c===d.down?(k.selectNext(),e=!0):c===d.up?(k.selectPrior(),e=!0):c===d.escape?(k.reset(),e=!0):(c===d.enter||c===d.tab)&&(e=b.addSuggestion()),e&&(a.preventDefault(),a.stopImmediatePropagation(),b.$apply()))}}).on("input-blur",function(){k.reset()}),a.on("click",function(){k.visible&&(k.reset(),b.$apply())})}}}]),e.directive("tiTranscludeAppend",function(){return function(a,b,c,d,e){e(function(a){b.append(a)})}}),e.directive("tiAutosize",function(){return{restrict:"A",require:"ngModel",link:function(a,b,c,d){var e,f,g=3;e=angular.element('<span class="input"></span>'),e.css("display","none").css("visibility","hidden").css("width","auto").css("white-space","pre"),b.parent().append(e),f=function(a){var d,f=a;return angular.isString(f)&&0===f.length&&(f=c.placeholder),f&&(e.text(f),e.css("display",""),d=e.prop("offsetWidth"),e.css("display","none")),b.css("width",d?d+g+"px":""),a},d.$parsers.unshift(f),d.$formatters.unshift(f)}}}),e.provider("tagsInputConfig",function(){var a={};this.setDefaults=function(b,c){return a[b]=c,this},this.$get=["$interpolate",function(b){var c={};return c[String]=function(a){return a},c[Number]=function(a){return parseInt(a,10)},c[Boolean]=function(a){return"true"===a.toLowerCase()},c[RegExp]=function(a){return new RegExp(a)},{load:function(d,e,f,g){e.options={},angular.forEach(g,function(g,h){var i=f[h]&&b(f[h])(e.$parent),j=c[g[0]],k=function(b){var c=a[d]&&a[d][b];return angular.isDefined(c)?c:g[1]};e.options[h]=i?j(i):k(h)})}}}]}),e.run(["$templateCache",function(a){a.put("ngTagsInput/tags-input.html",'<div class="host" tabindex="-1" ti-transclude-append=""><div class="tags" ng-class="{focused: hasFocus}"><ul class="tag-list"><li class="tag-item" ng-repeat="tag in tagList.items track by track(tag)" ng-class="{ selected: tag == tagList.selected }"><span>{{getDisplayText(tag)}}</span> <a class="remove-button" ng-click="tagList.remove($index)">{{options.removeTagSymbol}}</a></li></ul><input class="input" placeholder="{{options.placeholder}}" maxlength="{{options.maxLength}}" tabindex="{{options.tabindex}}" ng-model="newTag" ng-change="newTagChange()" ng-trim="false" ti-autosize=""></div></div>'),a.put("ngTagsInput/auto-complete.html",'<div class="autocomplete" ng-show="suggestionList.visible"><ul class="suggestion-list"><li class="suggestion-item" ng-repeat="item in suggestionList.items | limitTo:options.maxResultsToShow track by track(item)" ng-class="{selected: item == suggestionList.selected}" ng-click="addSuggestion()" ng-mouseenter="suggestionList.select($index)" ng-bind-html="highlight(item)"></li></ul></div>')}])}();